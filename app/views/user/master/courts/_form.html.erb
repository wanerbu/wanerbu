<%= semantic_form_for([:user, :master, @court], :html => { :class => 'form-horizontal' }) do |f| %>
<%= f.inputs :name => t('views.defaults.label.base_info') do %>
  <!--新建-->
  <% if @court.new_record? %>
    <%= f.input :sport_id, :label => "项目", :required => true, :as => :select,:collection => Sport.all %>
    <%= f.input :reservation_type, :as => :radio %>
    <!--异步请求返回所选项目的属性显示层-->
    <div id="courtProperties">
    </div>  
  <!--编辑-->
  <% else %>
    <li id="court_sport_name" class="number input optional numeric stringish">
      <label class=" label" for="court_sport_name">项目</label>
      <%= Sport.find(@court.sport_id).name %>
    </li>
    <li id="court_sport_name" class="number input optional numeric stringish">
      <label class=" label" for="reservation_type"><%= Court.human_attribute_name(:reservation_type) %></label>
        <%= @court.reservation_type.text -%>
    </li>
    <div id="courtPropertiesIfEdit">
      <% @court.court_properties.all.each do |court_property| %>
      <% property = Property.find(court_property.property_id) %>
      <div>
        <%= hidden_field_tag 'court[court_properties_attributes][][id]',court_property.id %>
        <%= hidden_field_tag 'court[court_properties_attributes][][property_id]',property.id %>
        <li id="court_sport_name" class="number input optional numeric stringish">
          <label class=" label" for="court_sport_name">
            <%= label_tag :property_ids, property.name -%>
          </label>
          <%= text_field_tag 'court[court_properties_attributes][][property_value]',court_property.property_value %>
          <%= property.unit -%>
        </li>
      </div>
      <%end%>
    </div>  
  <% end %>
    <%= f.input :min_unit %>
<% end %>
<%= f.inputs :name => t('views.defaults.label.batch_game_info') do %>
    <li id="court_game_number" class="number input optional numeric stringish">
      <label class=" label" for="court_gane_number">场次数量 </label>
      <% if @court.new_record? %>
        <%= text_field_tag 'game_number',1 %>
      <% else %>
        <%= text_field_tag 'game_number',Game.where(:court_id => @court.id).count %>
      <%end%>
    </li>
    <li id="court_game_price" class="number input optional numeric stringish">
      <label class=" label" for="court_game_price">场次默认价格 </label>
      <% if @court.new_record? %>
        <%= text_field_tag 'game_default_price',1 %>
      <% else %>
        <%= text_field_tag 'game_default_price', (Game.where(:court_id => @court.id).first.nil?) ? "" : Game.where(:court_id => @court.id).first.default_price %>
      <%end%>
    </li>
    <li id="court_game_can_reservation" class="number input optional numeric stringish">
        <label class=" label" for="court_game_can_reservation">能否预订</label>
      <ol class="choices-group">
        <li class="choice">
          <label for="court_game_can_reservation_true">
            <% if @court.new_record? or !@court.new_record? and (Game.where(:court_id => @court.id).first.nil?) ? true : Game.where(:court_id => @court.id).first.can_reservation %>
               <%= radio_button_tag("can_reservation", true,true) %>可以预订
          <% else %>
               <%= radio_button_tag("can_reservation", true) %>可以预订
           <%end%>
          </label>
        </li>
        <li class="choice">
          <label for="court_game_can_reservation_false">
            <% if  !@court.new_record? and !((Game.where(:court_id => @court.id).first.nil?) ? false : Game.where(:court_id => @court.id).first.can_reservation) %>
            <%= radio_button_tag("can_reservation", false,true) %>不可以预订
          <% else %>
            <%= radio_button_tag("can_reservation", false) %>不可以预订
           <%end%>
          </label>
        </li>
      </ol>
    </li>
<% end %>
    <%= f.actions do %>
      <%= f.action :submit, :button_html => { :class => "btn btn-primary" }, :as => :button %>
      <%= f.action :cancel, :as => :link %>
    <% end -%>
<% end %>
